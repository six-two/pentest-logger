import os
from pt_helper import ParamManipulator, ParamInfo, Settings, BaseToolWrapper
from pt_helper.utils import ArgumentRater, NMAP


# -V is short for --version
FLAG_BLOCKLIST = ["-V", "--version", "-h", "--help"]

# nmap -h | grep oA
# -oA <basename>: Output in the three major formats at once
OUTPUT_ALL = ParamInfo("-oA")

class Nmap(BaseToolWrapper):
    def __init__(self, settings: Settings) -> None:
        super().__init__(settings, FLAG_BLOCKLIST, None, [NMAP])

    def rewrite_arguments_custom(self, params: ParamManipulator, output_dir: str) -> None:
        output_file = os.path.join(output_dir, "results")
        params.add(OUTPUT_ALL, [output_file])
