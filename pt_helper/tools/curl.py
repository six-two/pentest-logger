# local files
from pt_helper import ParamManipulator, ParamInfo, Settings, BaseToolWrapper
from pt_helper.utils import HOSTNAME, IP_ADDRESS

# -h is short for --header
FLAG_BLOCKLIST = ["-V", "--version", "-h", "--help"]

# curl --help all|grep proxy
# -x, --proxy [protocol://]host[:port]  Use this proxy
PROXY = ParamInfo("--proxy", ["-x"])

# There are way to many output options to check for them all

TARGET_PATTERN_LIST = [
    # Protocol? + Host + Port? + Path?
    r"(https://)?"
    + f"({HOSTNAME}|{IP_ADDRESS})"
    + r"(:\d{1,5})?"
    + r"(\/.*)?"
]


class Curl(BaseToolWrapper):
    def __init__(self, settings: Settings) -> None:
        super().__init__(settings, FLAG_BLOCKLIST, PROXY, TARGET_PATTERN_LIST)
